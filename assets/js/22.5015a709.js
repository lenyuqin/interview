(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{429:function(n,t,a){"use strict";a.r(t);var s=a(21),e=Object(s.a)({},(function(){var n=this,t=n.$createElement,a=n._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[a("h2",{attrs:{id:"springbootapplication"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#springbootapplication"}},[n._v("#")]),n._v(" @SpringBootApplication")]),n._v(" "),a("p",[n._v("这个是一个非常核心的注解，我们使用springboot项目一般都是只需要开启这个就可以了，这个是一个组合注解，里面有三个非常重要的注解")]),n._v(" "),a("ul",[a("li",[n._v("@Configuration（@SpringBootConfiguration点开查看发现里面还是应用了@Configuration）")]),n._v(" "),a("li",[n._v("@EnableAutoConfiguration")]),n._v(" "),a("li",[n._v("@ComponentScan")])]),n._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[n._v("@Target")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[n._v("ElementType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("TYPE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[n._v("@Retention")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[n._v("RetentionPolicy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("RUNTIME"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[n._v("@Documented")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[n._v("@Inherited")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[n._v("@SpringBootConfiguration")]),a("span",{pre:!0,attrs:{class:"token comment"}},[n._v("//配置类")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[n._v("@EnableAutoConfiguration")]),a("span",{pre:!0,attrs:{class:"token comment"}},[n._v("//自动配置")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[n._v("@ComponentScan")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),a("span",{pre:!0,attrs:{class:"token comment"}},[n._v("//扫描容器")]),n._v("\n    excludeFilters "),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[n._v("@Filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("\n    type "),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[n._v("FilterType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("CUSTOM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n    classes "),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[n._v("TypeExcludeFilter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[n._v("@Filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("\n    type "),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[n._v("FilterType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("CUSTOM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n    classes "),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[n._v("AutoConfigurationExcludeFilter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("public")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[n._v("@interface")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[n._v("SpringBootApplication")]),n._v(" \n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br")])]),a("h4",{attrs:{id:"configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configuration"}},[n._v("#")]),n._v(" @Configuration")]),n._v(" "),a("p",[n._v("@Configuration这个注解其实就是把我们的配置类都注入到IOC容器中，一般情况下，我们有两种方式来配置")]),n._v(" "),a("p",[n._v("任何一个标注了@Bean的方法，其返回值将作为一个bean定义注册到Spring的IoC容器，方法名将默认成该bean定义的id")]),n._v(" "),a("h4",{attrs:{id:"componentscan"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#componentscan"}},[n._v("#")]),n._v(" @ComponentScan")]),n._v(" "),a("p",[n._v("@ComponentScan这个注解在Spring中很重要，它对应XML配置中的元素，@ComponentScan的功能其实就是自动扫描并加载符合条件的组件（比如@Component和@Repository等）或者bean定义，最终将这些bean定义加载到IoC容器中。")]),n._v(" "),a("p",[n._v("我们可以通过basePackages等属性来细粒度的定制@ComponentScan自动扫描的范围，如果不指定，则默认Spring框架实现会从声明@ComponentScan所在类的package进行扫描。")]),n._v(" "),a("p",[n._v("注：所以SpringBoot的启动类最好是放在root package下，因为默认不指定basePackages。")]),n._v(" "),a("h4",{attrs:{id:"enableautoconfiguration-注解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#enableautoconfiguration-注解"}},[n._v("#")]),n._v(" @EnableAutoConfiguration 注解")]),n._v(" "),a("p",[n._v("Spring框架提供的各种名字为@Enable开头的Annotation定义？比如@EnableScheduling、@EnableCaching、@EnableMBeanExport等，@EnableAutoConfiguration的理念和做事方式其实一脉相承，简单概括一下就是，"),a("strong",[n._v("借助@Import的支持，收集和注册特定场景相关的bean定义。")])]),n._v(" "),a("p",[n._v("而@EnableAutoConfiguration也是借助@Import的帮助，将所有符合自动配置条件的bean定义加载到IoC容器")]),n._v(" "),a("p",[n._v("@EnableAutoConfiguration作为一个复合Annotation，其自身定义关键信息如下：")]),n._v(" "),a("p",[n._v("借助于Spring框架原有的一个工具类：SpringFactoriesLoader的支持，@EnableAutoConfiguration可以智能的自动配置。")]),n._v(" "),a("p",[n._v("SpringFactoriesLoader属于Spring框架私有的一种扩展方案，其主要功能就是从指定的配置文件META-INF/spring.factories加载配置。")]),n._v(" "),a("p",[a("img",{attrs:{src:"https://img.xiaoyou66.com/2021/04/05/ae7fe073a6ba8.png",alt:"img"}})]),n._v(" "),a("h2",{attrs:{id:"springboot启动流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#springboot启动流程"}},[n._v("#")]),n._v(" Springboot启动流程")]),n._v(" "),a("p",[a("img",{attrs:{src:"https://img.xiaoyou66.com/2021/04/05/874ed780ad465.png",alt:"image.png"}})]),n._v(" "),a("p",[n._v("我们将各步骤总结精炼如下：")]),n._v(" "),a("ol",[a("li",[n._v("通过 "),a("code",[n._v("SpringFactoriesLoader")]),n._v(" 加载 "),a("code",[n._v("META-INF/spring.factories")]),n._v(" 文件，获取并创建 "),a("code",[n._v("SpringApplicationRunListener")]),n._v(" 对象")]),n._v(" "),a("li",[n._v("然后由 "),a("code",[n._v("SpringApplicationRunListener")]),n._v(" 来发出 starting 消息")]),n._v(" "),a("li",[n._v("创建参数，并配置当前 SpringBoot 应用将要使用的 Environment")]),n._v(" "),a("li",[n._v("完成之后，依然由 "),a("code",[n._v("SpringApplicationRunListener")]),n._v(" 来发出 environmentPrepared 消息")]),n._v(" "),a("li",[n._v("创建 "),a("code",[n._v("ApplicationContext")])]),n._v(" "),a("li",[n._v("初始化 "),a("code",[n._v("ApplicationContext")]),n._v("，并设置 Environment，加载相关配置等")]),n._v(" "),a("li",[n._v("由 "),a("code",[n._v("SpringApplicationRunListener")]),n._v(" 来发出 "),a("code",[n._v("contextPrepared")]),n._v(" 消息，告知SpringBoot 应用使用的 "),a("code",[n._v("ApplicationContext")]),n._v(" 已准备OK")]),n._v(" "),a("li",[n._v("将各种 beans 装载入 "),a("code",[n._v("ApplicationContext")]),n._v("，继续由 "),a("code",[n._v("SpringApplicationRunListener")]),n._v(" 来发出 contextLoaded 消息，告知 SpringBoot 应用使用的 "),a("code",[n._v("ApplicationContext")]),n._v(" 已装填OK")]),n._v(" "),a("li",[n._v("refresh ApplicationContext，完成IoC容器可用的最后一步")]),n._v(" "),a("li",[n._v("由 "),a("code",[n._v("SpringApplicationRunListener")]),n._v(" 来发出 started 消息")]),n._v(" "),a("li",[n._v("完成最终的程序的启动")]),n._v(" "),a("li",[n._v("由 "),a("code",[n._v("SpringApplicationRunListener")]),n._v(" 来发出 running 消息，告知程序已运行起来了")])])])}),[],!1,null,null,null);t.default=e.exports}}]);